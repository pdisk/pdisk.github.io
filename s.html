<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="test" class="test"></div>
    <h1> Please Wait</h1>
    <script>
        function wait(ms){
   var start = new Date().getTime();
   var end = start;
   while(end < start + ms) {
     end = new Date().getTime();
  }
}
        s = document.createElement("script")
        s.type = "text/javascript"
        if (document.referrer.indexOf("shorturllink") !== -1 || (document.referrer.indexOf("textpage") !== -1)) {
            s.src = 'https://mdisks.herokuapp.com/moviediskbot.js'
        }
        else {
            s.src = 'https://mdisks.herokuapp.com/Moviediskbot.js'
        }
        document.getElementsByTagName("head")[0].appendChild(s)

        async function delay(delayInms) {
            return new Promise(resolve  => {
                setTimeout(() => {
                    resolve(2);
                 }, delayInms);
            });
       }
    async function waitforjs() {   
        while (true) {
        e = document.getElementById("test").classList
        await delay(200);
        if (e.contains("1") || e.contains("0")) {
            break
        }
        console.log("waiting")        
        }
        waitforjs()
        console.log("finished")
        loc = location + ""
        param = loc.split("=").slice(-1)[0]
        mdisk = "https://pdisk.github.io/s?=" + param
        
   
        if (document.getElementsByClassName("test")[0].classList.contains("1")) {
            console.log(mdisk)
        }
        else {
        slink = "https://shorturllink.in/api?api=fd5417a3b3d75bae1bd71bc5168c78f16b801858&url=" + mdisk
        let res = fetch(slink);
        res.then(res => res.json()).then(res => console.log(res["shortenedUrl"]))
        }
    </script>
</body>
</html>
